<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include("./Partials/head") %>
    <title>HomePage</title>
  </head>

  <body>
    <%- include("./Partials/nav") %>
    <div class="container">
    <% if (!locals.user) { 
      const sections = [
        { title: "Songs", items: songs, type: "song" },
        { title: "Dance", items: dances, type: "dance" },
        { title: "Paintings", items: paintings, type: "painting" },
        { title: "Codes", items: codes, type: "code" },
        { title: "Photos", items: photos, type: "photo" }
      ];

      sections.forEach(section => {
        if (section.items.length) { %>
          <h1 class="mt-3" style="color: blue"><%= section.title %>:</h1>
          <div class="row row-cols-1 row-cols-md-3 g-4 mt-3">
            <% section.items.forEach(item => { %>
              <div class="col">
                <div class="card h-100" style="width: 18rem;">
                  <img src="<%= item.coverImageURL %>" class="card-img-top" style="height: 5cm;" alt="<%= item.title %>" loading="lazy">
                  <div class="card-body">
                    <h5 class="card-title"><%= item.title %></h5>
                    <a href="/<%= section.type %>/<%= item._id %>" class="btn btn-primary">View</a>
                  </div>
                </div>
              </div>
            <% }) %>
          </div>
        <% } 
      }); 
    } else if (Array.isArray(locals.user.interestedFields)) {
      const interestMap = {
        SINGING: { items: songs, type: "song", title: "Songs" },
        DANCING: { items: dances, type: "dance", title: "Dance" },
        DRAWING: { items: paintings, type: "painting", title: "Paintings" },
        CODING: { items: codes, type: "code", title: "Codes" },
        PHOTOGRAPHY: { items: photos, type: "photo", title: "Photos" }
      };

      for (let key in interestMap) {
        if (locals.user.interestedFields.includes(key) || locals.user.interestedFields.includes("ALL")) {
          const section = interestMap[key];
          if (section.items.length) { %>
            <h1 class="mt-3" style="color: blue"><%= section.title %>:</h1>
            <div class="row row-cols-1 row-cols-md-3 g-4 mt-3">
              <% section.items.forEach(item => { %>
                <div class="col">
                  <div class="card h-100" style="width: 18rem;">
                    <img src="<%= item.coverImageURL %>" class="card-img-top" style="height: 5cm;" alt="<%= item.title %>" loading="lazy">
                    <div class="card-body">
                      <h5 class="card-title"><%= item.title %></h5>
                      <a href="/<%= section.type %>/<%= item._id %>" class="btn btn-primary">View</a>
                    </div>
                  </div>
                </div>
              <% }) %>
            </div>
          <% } 
        }
      }
    } %>
    </div>
    <%- include("./Partials/scripts") %>
  </body>
</html>